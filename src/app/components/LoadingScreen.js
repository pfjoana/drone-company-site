'use client';

import { useEffect, useState, useRef } from 'react';
import { gsap } from 'gsap';

const LoadingScreen = ({ onLoadingComplete }) => {
  const [isLoading, setIsLoading] = useState(true);
  const loadingRef = useRef(null);
  const logoRef = useRef(null);
  const fillRef = useRef(null);

  useEffect(() => {
    // Timeline principal do loading
    const tl = gsap.timeline();

    // 1. Entrada suave do logo
    tl.fromTo(logoRef.current,
      {
        scale: 0.8,
        opacity: 0
      },
      {
        scale: 1,
        opacity: 1,
        duration: 1.2,
        ease: "power2.out",
        delay: 0.3
      }
    )
    // 2. Preenchimento gradual do logo
    .fromTo(fillRef.current,
      {
        clipPath: 'polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)'
      },
      {
        clipPath: 'polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)',
        duration: 3.5,
        ease: "power2.inOut"
      },
      "-=0.5"
    )
    // 3. Pausa
    .to({}, { duration: 0.8 })
    // 4. SaÃ­da suave
    .to(logoRef.current, {
      scale: 1.1,
      opacity: 0,
      duration: 0.8,
      ease: "power2.inOut"
    })
    .to(loadingRef.current, {
      opacity: 0,
      duration: 1,
      ease: "power2.inOut",
      onComplete: () => {
        setIsLoading(false);
        onLoadingComplete?.();
      }
    }, "-=0.4")
    .set(loadingRef.current, {
      display: 'none'
    });

  }, [onLoadingComplete]);

  if (!isLoading) return null;

  return (
    <div
      ref={loadingRef}
      className="fixed inset-0 bg-black z-50 flex items-center justify-center"
    >
      {/* Logo */}
      <div ref={logoRef} className="relative">
        <svg
          width="140"
          height="140"
          viewBox="0 0 350.88 348.46"
          className="text-gray-600"
        >
          <path
            fill="currentColor"
            d="M310.44,163.89,4.52,140.66a1.83,1.83,0,0,0-2,1.7C2,149.88.14,178.3,0,185.87a1.62,1.62,0,0,0,1.75,1.65Z"
          />
          <path
            fill="currentColor"
            d="M34.52,71.37l-21,36.92A2.2,2.2,0,0,0,15,111.55l295.43,52.34S135.73,88,36.78,70.3A2.16,2.16,0,0,0,34.52,71.37Z"
          />
          <path
            fill="currentColor"
            d="M92.53,20.86C88.12,23.83,68.39,37.2,59.6,45A1.16,1.16,0,0,0,60,46.9c18.52,6.75,175.78,64.83,250.47,117,0,0-136.17-109.69-216-143.22A2,2,0,0,0,92.53,20.86Z"
          />
          <path
            fill="currentColor"
            d="M154.37.16c-4.7.88-27.67,5.3-36.11,8.47a.83.83,0,0,0-.14,1.48C131.4,18.6,239.69,88.76,310.44,163.89c0,0-90.61-108.09-154.58-163.33A1.75,1.75,0,0,0,154.37.16Z"
          />
          <path
            fill="currentColor"
            d="M208.64,0H179.19a1,1,0,0,0-.67,1.69c12.34,11.44,84,79.54,131.92,162.2,0,0-78.9-142.91-100.71-163.47A1.55,1.55,0,0,0,208.64,0Z"
          />
          <path
            fill="currentColor"
            d="M277.53,29.27,262,20.9a.52.52,0,0,0-.74.63l49.19,142.36L278.11,30A1.16,1.16,0,0,0,277.53,29.27Z"
          />
          <path
            fill="currentColor"
            d="M296.45,45.17l-9.92-7.3a.44.44,0,0,0-.69.44l24.6,125.58L297,46.12A1.43,1.43,0,0,0,296.45,45.17Z"
          />
          <path
            fill="currentColor"
            d="M311.94,61.64l-6.27-6.92a.35.35,0,0,0-.62.25l5.39,108.92L312.3,62.6A1.37,1.37,0,0,0,311.94,61.64Z"
          />
          <path
            fill="currentColor"
            d="M322.23,74.7l-5.62-6.25a.48.48,0,0,0-.83.3l-5.34,95.14,12.13-88.11A1.34,1.34,0,0,0,322.23,74.7Z"
          />
          <path
            fill="currentColor"
            d="M332.16,89.61l-5.33-6.83a.48.48,0,0,0-.85.2l-15.54,80.91,21.89-73.33A1.07,1.07,0,0,0,332.16,89.61Z"
          />
          <path
            fill="currentColor"
            d="M342.48,115.26l-2.94-6a.51.51,0,0,0-.91,0l-28.19,54.65,32-47.7A1,1,0,0,0,342.48,115.26Z"
          />
          <path
            fill="currentColor"
            d="M346.71,128.69l-2.21-7.13a.48.48,0,0,0-.83-.15l-33.23,42.48,36-34.11A1.05,1.05,0,0,0,346.71,128.69Z"
          />
          <path
            fill="currentColor"
            d="M348.9,141.66l-1.28-7.07a.43.43,0,0,0-.69-.26l-36.49,29.56,38-21.28A.9.9,0,0,0,348.9,141.66Z"
          />
          <path
            fill="currentColor"
            d="M351.69,168.8v-7.63a.75.75,0,0,0-.82-.75l-40.43,3.47,40.73,5.37A.46.46,0,0,0,351.69,168.8Z"
          />
          <path
            fill="currentColor"
            d="M351.69,182.13V174.4a.67.67,0,0,0-.51-.65l-40.74-9.86,40.49,18.73A.54.54,0,0,0,351.69,182.13Z"
          />
          <path
            fill="currentColor"
            d="M350.88,198.72v-8.85a.89.89,0,0,0-.41-.74l-40-25.24Z"
          />
          <path
            fill="currentColor"
            d="M348.13,210.48l.72-6.2a2.86,2.86,0,0,0-.8-2.34l-37.61-38.05,36.64,46.88A.59.59,0,0,0,348.13,210.48Z"
          />
          <path
            fill="currentColor"
            d="M342.49,228.79l3.93-7.25a1.69,1.69,0,0,0-.06-1.75l-35.92-55.9,30.71,64.86A.75.75,0,0,0,342.49,228.79Z"
          />
          <path
            fill="currentColor"
            d="M333,255.33l-6.31,6.58a.55.55,0,0,1-.95-.3l-15.25-97.72s21.52,68.83,23,90.19A1.65,1.65,0,0,1,333,255.33Z"
          />
          <path
            fill="currentColor"
            d="M323.24,270.19c-.76,1.07-4.29,6-5.9,8.25a.48.48,0,0,1-.87-.25l-6-114.3s14.19,97.13,13,105.78A1.19,1.19,0,0,1,323.24,270.19Z"
          />
          <path
            fill="currentColor"
            d="M309.56,289.17,301.28,297a.81.81,0,0,1-1.37-.64l10.53-132.51V287.13A2.81,2.81,0,0,1,309.56,289.17Z"
          />
          <path
            fill="currentColor"
            d="M291.36,306.9,280,315a.82.82,0,0,1-1.29-.84l31.7-150.22L292.79,304.51A3.46,3.46,0,0,1,291.36,306.9Z"
          />
          <path
            fill="currentColor"
            d="M267.59,324.39l-15.65,7.21a1.48,1.48,0,0,1-2-1.85l60.51-165.86s-32.5,142.4-41.35,159.1A3.18,3.18,0,0,1,267.59,324.39Z"
          />
          <path
            fill="currentColor"
            d="M190.25,348.46H162.2a1.55,1.55,0,0,1-1.15-2.6c17.06-18.48,120-130.71,149.39-182,0,0-81.36,151.57-116.67,183.23A5.24,5.24,0,0,1,190.25,348.46Z"
          />
          <path
            fill="currentColor"
            d="M132.87,343.78l-32.1-12.13a1.43,1.43,0,0,1-.31-2.52c20.34-14,172-119.16,210-165.24,0,0-152,174.56-173.85,179.76A6.31,6.31,0,0,1,132.87,343.78Z"
          />
          <path
            fill="currentColor"
            d="M70.09,312.39,42.42,285.77a1.86,1.86,0,0,1,.7-3.1c25.51-8.49,211.21-71.33,267.32-118.78,0,0-119.23,97.31-235.47,149.36A4.45,4.45,0,0,1,70.09,312.39Z"
          />
        </svg>

        {/* Logo preenchido (branco) - sobreposto com clip-path */}
        <svg
          ref={fillRef}
          width="140"
          height="140"
          viewBox="0 0 350.88 348.46"
          className="text-white absolute top-0 left-0"
          style={{
            clipPath: 'polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)'
          }}
        >
          <path
            fill="currentColor"
            d="M310.44,163.89,4.52,140.66a1.83,1.83,0,0,0-2,1.7C2,149.88.14,178.3,0,185.87a1.62,1.62,0,0,0,1.75,1.65Z"
          />
          <path
            fill="currentColor"
            d="M34.52,71.37l-21,36.92A2.2,2.2,0,0,0,15,111.55l295.43,52.34S135.73,88,36.78,70.3A2.16,2.16,0,0,0,34.52,71.37Z"
          />
          <path
            fill="currentColor"
            d="M92.53,20.86C88.12,23.83,68.39,37.2,59.6,45A1.16,1.16,0,0,0,60,46.9c18.52,6.75,175.78,64.83,250.47,117,0,0-136.17-109.69-216-143.22A2,2,0,0,0,92.53,20.86Z"
          />
          <path
            fill="currentColor"
            d="M154.37.16c-4.7.88-27.67,5.3-36.11,8.47a.83.83,0,0,0-.14,1.48C131.4,18.6,239.69,88.76,310.44,163.89c0,0-90.61-108.09-154.58-163.33A1.75,1.75,0,0,0,154.37.16Z"
          />
          <path
            fill="currentColor"
            d="M208.64,0H179.19a1,1,0,0,0-.67,1.69c12.34,11.44,84,79.54,131.92,162.2,0,0-78.9-142.91-100.71-163.47A1.55,1.55,0,0,0,208.64,0Z"
          />
          <path
            fill="currentColor"
            d="M277.53,29.27,262,20.9a.52.52,0,0,0-.74.63l49.19,142.36L278.11,30A1.16,1.16,0,0,0,277.53,29.27Z"
          />
          <path
            fill="currentColor"
            d="M296.45,45.17l-9.92-7.3a.44.44,0,0,0-.69.44l24.6,125.58L297,46.12A1.43,1.43,0,0,0,296.45,45.17Z"
          />
          <path
            fill="currentColor"
            d="M311.94,61.64l-6.27-6.92a.35.35,0,0,0-.62.25l5.39,108.92L312.3,62.6A1.37,1.37,0,0,0,311.94,61.64Z"
          />
          <path
            fill="currentColor"
            d="M322.23,74.7l-5.62-6.25a.48.48,0,0,0-.83.3l-5.34,95.14,12.13-88.11A1.34,1.34,0,0,0,322.23,74.7Z"
          />
          <path
            fill="currentColor"
            d="M332.16,89.61l-5.33-6.83a.48.48,0,0,0-.85.2l-15.54,80.91,21.89-73.33A1.07,1.07,0,0,0,332.16,89.61Z"
          />
          <path
            fill="currentColor"
            d="M342.48,115.26l-2.94-6a.51.51,0,0,0-.91,0l-28.19,54.65,32-47.7A1,1,0,0,0,342.48,115.26Z"
          />
          <path
            fill="currentColor"
            d="M346.71,128.69l-2.21-7.13a.48.48,0,0,0-.83-.15l-33.23,42.48,36-34.11A1.05,1.05,0,0,0,346.71,128.69Z"
          />
          <path
            fill="currentColor"
            d="M348.9,141.66l-1.28-7.07a.43.43,0,0,0-.69-.26l-36.49,29.56,38-21.28A.9.9,0,0,0,348.9,141.66Z"
          />
          <path
            fill="currentColor"
            d="M351.69,168.8v-7.63a.75.75,0,0,0-.82-.75l-40.43,3.47,40.73,5.37A.46.46,0,0,0,351.69,168.8Z"
          />
          <path
            fill="currentColor"
            d="M351.69,182.13V174.4a.67.67,0,0,0-.51-.65l-40.74-9.86,40.49,18.73A.54.54,0,0,0,351.69,182.13Z"
          />
          <path
            fill="currentColor"
            d="M350.88,198.72v-8.85a.89.89,0,0,0-.41-.74l-40-25.24Z"
          />
          <path
            fill="currentColor"
            d="M348.13,210.48l.72-6.2a2.86,2.86,0,0,0-.8-2.34l-37.61-38.05,36.64,46.88A.59.59,0,0,0,348.13,210.48Z"
          />
          <path
            fill="currentColor"
            d="M342.49,228.79l3.93-7.25a1.69,1.69,0,0,0-.06-1.75l-35.92-55.9,30.71,64.86A.75.75,0,0,0,342.49,228.79Z"
          />
          <path
            fill="currentColor"
            d="M333,255.33l-6.31,6.58a.55.55,0,0,1-.95-.3l-15.25-97.72s21.52,68.83,23,90.19A1.65,1.65,0,0,1,333,255.33Z"
          />
          <path
            fill="currentColor"
            d="M323.24,270.19c-.76,1.07-4.29,6-5.9,8.25a.48.48,0,0,1-.87-.25l-6-114.3s14.19,97.13,13,105.78A1.19,1.19,0,0,1,323.24,270.19Z"
          />
          <path
            fill="currentColor"
            d="M309.56,289.17,301.28,297a.81.81,0,0,1-1.37-.64l10.53-132.51V287.13A2.81,2.81,0,0,1,309.56,289.17Z"
          />
          <path
            fill="currentColor"
            d="M291.36,306.9,280,315a.82.82,0,0,1-1.29-.84l31.7-150.22L292.79,304.51A3.46,3.46,0,0,1,291.36,306.9Z"
          />
          <path
            fill="currentColor"
            d="M267.59,324.39l-15.65,7.21a1.48,1.48,0,0,1-2-1.85l60.51-165.86s-32.5,142.4-41.35,159.1A3.18,3.18,0,0,1,267.59,324.39Z"
          />
          <path
            fill="currentColor"
            d="M190.25,348.46H162.2a1.55,1.55,0,0,1-1.15-2.6c17.06-18.48,120-130.71,149.39-182,0,0-81.36,151.57-116.67,183.23A5.24,5.24,0,0,1,190.25,348.46Z"
          />
          <path
            fill="currentColor"
            d="M132.87,343.78l-32.1-12.13a1.43,1.43,0,0,1-.31-2.52c20.34-14,172-119.16,210-165.24,0,0-152,174.56-173.85,179.76A6.31,6.31,0,0,1,132.87,343.78Z"
          />
          <path
            fill="currentColor"
            d="M70.09,312.39,42.42,285.77a1.86,1.86,0,0,1,.7-3.1c25.51-8.49,211.21-71.33,267.32-118.78,0,0-119.23,97.31-235.47,149.36A4.45,4.45,0,0,1,70.09,312.39Z"
          />
        </svg>
      </div>
    </div>
  );
};

export default LoadingScreen;
